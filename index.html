<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.112.3"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Qiao</title><meta name=keywords content="Blog,Portfolio,PaperMod"><meta name=description content><meta name=author content="Qiao"><link rel=canonical href=https://tanjoe.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><link rel=icon href=https://tanjoe.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://tanjoe.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://tanjoe.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://tanjoe.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://tanjoe.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://tanjoe.github.io/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>const config={startOnLoad:!0,theme:"forest",themeVariables:{lineColor:"#fafafa"},flowchart:{useMaxWidth:!1,htmlLabels:!0}};mermaid.initialize(config),window.onload=()=>{window.mermaid.init(void 0,document.querySelectorAll(".language-mermaid"))}</script><meta property="og:title" content="Qiao"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://tanjoe.github.io/"><meta property="og:image" content="https://tanjoe.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="Qiao"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tanjoe.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Qiao"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Qiao","url":"https://tanjoe.github.io/","description":"","thumbnailUrl":"https://tanjoe.github.io/%3Clink%20/%20abs%20url%3E","sameAs":["https://github.com/tanjoe","https://stackoverflow.com/users/9667324/tanjor","index.xml"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tanjoe.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://tanjoe.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tanjoe.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://tanjoe.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>Qiao</h1></header><div class=entry-content></div><footer class=entry-footer><div class=social-icons><a href=https://github.com/tanjoe target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://stackoverflow.com/users/9667324/tanjor target=_blank rel="noopener noreferrer me" title=Stackoverflow><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.913 16.041v6.848h17.599v-6.848M7.16 18.696h8.925M7.65 13.937l8.675 1.8M9.214 9.124l8.058 3.758M12.086 4.65l6.849 5.66M15.774 1.111l5.313 7.162"/></svg></a><a href=index.xml target=_blank rel="noopener noreferrer me" title=Rss><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2>OpenCV鱼眼模型理解</h2></header><div class=entry-content><p>鱼眼模型介绍 这里直接截取鱼眼镜头的成像原理到畸变矫正的原文作为此文的引子：
鱼眼镜头一般是由十几个不同的透镜组合而成的。在成像的过程中，入射光线经过不同程度的折射，投影到尺寸有限的成像平面上，使得鱼眼镜头与普通镜头相比起来拥有了更大的视野范围。
在研究鱼眼相机成像时，可以将上面的镜头组简化为一个球面：
图中，$O_1-X_cY_cZ_c$是相机坐标系，$O_2-xy$是成像平面。世界中有一点$P$，入射角为$\theta$。如果按照针孔相机模型，入射光线$PO_1$经过镜头后不改变路线，$p’$为$P$的成像点。但对于鱼眼相机，入射光线经过镜头后会发生折射，因此$p$才是$P$的成像点，极坐标表示为$(r, \varphi)$ 。
可以用投影函数来对光线的折射建模。根据投影函数的不同，鱼眼相机的传统模型大致能被分为五种：透视投影（即针孔相机模型）、等积投影、等距投影、体视投影、正交投影。
投影模型 投影函数 特征 i. 透视投影 (perspective projection) $r = ftan\theta$ 针孔相机模型 ii. 体视投影 (stereographic projection) $r = 2ftan\frac \theta 2$​ 任何直线相交的角度，在变换后保持不变 iii. 等距投影 (equidistance projection) $r = f\theta$ 物体成像面上距离画面中心的距离与入射角成正比 iv. 等积投影 (equisolid angle projection) $r = 2fsin\frac \theta 2$​ 在变换前后，物体所占的立体角大小不变 v. 正交投影 (orthogonal projection) $r = fsin\theta$ 投影畸变最大，而且最大视场角不能大于180° OpenCV所用模型 先看OpenCV文档的原文：
Let $P$ be a point in 3D of coordinates X in the world reference frame (stored in the matrix X) The coordinate vector of $P$ in the camera reference frame is:...</p></div><footer class=entry-footer><span title='2023-05-10 17:38:38 +0000 UTC'>2023-05-10</span>&nbsp;·&nbsp;Qiao</footer><a class=entry-link aria-label="post link to OpenCV鱼眼模型理解" href=https://tanjoe.github.io/posts/opencv%E9%B1%BC%E7%9C%BC%E6%A8%A1%E5%9E%8B%E7%90%86%E8%A7%A3/></a></article><article class=post-entry><header class=entry-header><h2>AirSim中针孔相机畸变的实现</h2></header><div class=entry-content><p>查阅AirSim的文档可知，AirSim支持通过simSetDistortionParams设置K1, K2, K3, P1, P2这5个畸变系数。UE镜头畸变模拟：OpenCV Lens Distortion一文提及过，Unreal的OpenCV Lens Distortion插件是通过生成的Post Process Material对UV坐标施加偏移来模拟镜头畸变。那么，AirSim又是如何处理的呢？
基本流程探究 打开任意集成了AirSim插件的Unreal工程，用Visual Studio翻阅工程源码，重点是AirSim插件的cpp代码。
在整个项目中搜索simSetDistortionParams，找到RPC客户端和服务端的实现。客户端：
// &lt;path-to-project>\Plugins\AirSim\Source\AirLib\src\api\RpcLibClientBase.cpp void RpcLibClientBase::simSetDistortionParam(const std::string& camera_name, const std::string& param_name, float value, const std::string& vehicle_name, bool external) { pimpl_->client.call("simSetDistortionParam", camera_name, param_name, value, vehicle_name, external); } 服务端：
// &lt;path-to-project>\Plugins\AirSim\Source\AirLib\src\api\RpcLibServerBase.cpp // 省略其余binding... pimpl_->server.bind("simSetDistortionParam", [&](const std::string& camera_name, const std::string& param_name, float value, const std::string& vehicle_name, bool external) -> void { getWorldSimApi()->setDistortionParam(param_name, value, CameraDetails(camera_name, vehicle_name, external)); }); // ... 顺藤摸瓜，找到WorldSimApi::setDistortionParam：...</p></div><footer class=entry-footer><span title='2023-05-04 15:21:17 +0000 UTC'>2023-05-04</span>&nbsp;·&nbsp;Qiao</footer><a class=entry-link aria-label="post link to AirSim中针孔相机畸变的实现" href=https://tanjoe.github.io/posts/airsim%E4%B8%AD%E9%92%88%E5%AD%94%E7%9B%B8%E6%9C%BA%E7%95%B8%E5%8F%98%E7%9A%84%E5%AE%9E%E7%8E%B0/></a></article><article class=post-entry><header class=entry-header><h2>UE镜头畸变模拟：OpenCV Lens Distortion</h2></header><div class=entry-content><p>出于仿真的需要，希望在Unreal中能模拟鱼眼镜头的畸变效果，看到UE官方提供了Lens Distortion和OpenCV Lens Distortion两款插件用于模拟镜头畸变，但可惜相关资料不多。UE的博文UE中的相机标定、畸变模拟与矫正 - Unreal Engine做了些介绍，但步骤却又不是很详尽，初学者如我使用时不免多绕了些路，遂写下此文。
插件介绍 这里结合UE中的相机标定、畸变模拟与矫正 - Unreal Engine的介绍，总结如下：
Lens Distortion和OpenCV Lens Distortion用的camera model是一样的，背后的原理也类似。都是根据相机畸变参数生成displacement map，以此模拟镜头畸变 Lens Distortion没有标定功能，且只包含了畸变系数的前几项 Lens Distortion通过shader生成displacement map，而OpenCV Lens Distortion通过OpenCV的API用CPU计算生成，前者效率更快。不过由于displacement map通常只生成一次，这里的效率差异不太重要 补充：什么是displacement map？
A displacement map is a type of texture that is used in 3D computer graphics to create the illusion of depth and detail on a surface without actually changing the geometry of the mesh. A displacement map is typically a grayscale image where the brightness values of each pixel correspond to the amount of displacement that should be applied to the surface at that point....</p></div><footer class=entry-footer><span title='2023-04-28 13:43:06 +0000 UTC'>2023-04-28</span>&nbsp;·&nbsp;Qiao</footer><a class=entry-link aria-label="post link to UE镜头畸变模拟：OpenCV Lens Distortion" href=https://tanjoe.github.io/posts/ue%E9%95%9C%E5%A4%B4%E7%95%B8%E5%8F%98%E6%A8%A1%E6%8B%9Fopencv-lens-distortion/></a></article><article class=post-entry><header class=entry-header><h2>PySide6 实践</h2></header><div class=entry-content><p>信号槽问题 Python中的任意函数都可以作为槽函数使用而无需使用@Slot装饰器，只要它符合与信号连接的规则(参数对应上)，使用@Slot显示地声明可以提高效率，而不需要Python去隐式地转换类型。
python - Is the PySide Slot Decorator Necessary? - Stack Overflow
另一篇文章Should I decorate slots in Pyside2 and if so how?的回答：
As to whether you should decorate the slots, it’s a little trickier to answer – but generally speaking no, you don’t need to.
The only place I know the slot decorator is needed is when a) using threads, as it ensures the decorated method is started in the correct thread, or b) when you want to explicitly map a given slot to a specific call signature (types) in C++....</p></div><footer class=entry-footer><span title='2023-04-25 10:49:46 +0000 UTC'>2023-04-25</span>&nbsp;·&nbsp;Qiao</footer><a class=entry-link aria-label="post link to PySide6 实践" href=https://tanjoe.github.io/posts/pyside6-%E5%AE%9E%E8%B7%B5/></a></article><article class=post-entry><header class=entry-header><h2>从Hexo到Hugo</h2></header><div class=entry-content><p>从Hexo到Hugo 背景 促使我从WordPress搬迁到Hexo，再决定从Hexo搬迁到Hugo的动机是：想尽可能简化写博客的流程，减少除文章撰写以外一切无关事务的精力消耗。
这一追求源于我对自身的观察。一天的精力里往往绝大部分都投入在工作之上，在闲暇中再挤出时间投入写作对意志力是个考验。以往使用WordPress时，一旦VPS的访问速度不佳，那登录后台、打开编辑器、调整样式过程中等待耗费的时间，就足以将不多的意志力消磨干净。
后续切到Hexo+Github Pages后，不得不说，这让博客的发布顺畅不少，不再需要登录后台，几乎不需要考虑排版，迁移站点时也不再有数据库的顾虑。唯一的麻烦是，每次修改文件后，需要调用Hexo CLI重新生成站点并推送到Github Pages仓库。这也意味着本地总得准备一份Node.js环境。思考一番后，前面通过使用Github Actions部署Hexo把生成和部署也自动化了，只需要写文章并推送即可。
这么愉快地用了些时日，但在和Obsidian的配合使用中，又发现了新的矛盾：
Hexo如果需要用相对路径引用图片，图片应置于文章同名的文件夹下。而在Obsidian中，我所采取的方式是图片集中放置于media目录下 笔记现在总是用Obsidian创建，但需要为Hexo复制一份需要发布的文章及资源，而重复总是不利于维护的 如果将Hexo仓库置于Obsidian Vault中，再将需要发布的文章直接放到Hexo仓库的posts目录下，虽然不用复制文章，但Obsidian Vault中会带入Hexo/Node.js相关的文件。这些文件和笔记无关，在整理笔记时无异于噪音 这些问题都可以通过修改笔记来迁就Hexo，但这就是前文所说的，文章撰写以外的事务。我现在相信：应当让博客工具迁就写作习惯，而不是调整写作习惯来适应工具。
方法 为解决以上矛盾，想到的方法是：
在Vault中新建一个文件夹（这里记作Publish），在其中初始化Git仓库，存放供发布的文章 新建一个静态站点文件夹，同样初始话Git仓库，Publish仓库作为Git子模块加入其中 静态站点生成器应支持相对路径，且对文件夹的名称无要求 这样Obsidian Vault中只需要存放笔记，至于静态站点生成相关的内容则不再其中。为了方便博客发布的流程，还应该做到：
推送静态站点仓库时，应自动生成和部署站点，免去本地生成站点的麻烦 在Publish仓库中推送时，应自动更新静态站点仓库，让子模块引用Publish仓库的最新提交，免去需要在两个仓库中提交和推送的麻烦 做到这些后，应当可以：
不需要为了发布而改变记录笔记的方式 只维护一份需发布的资源 只需推送文章到远端，站点即能自动更新，本地不需要配置环境或手动生成站点 本想看看有没有办法让Hexo支持任意文件夹名的相对路径，但惊讶地发现并没有轻松的方式实现（我原以为这是非常常见的需求）。Gatsby/Jekyll/Hugo等一众工具也不原生支持此需求，这似乎与文件名到URL的映射有关。不过 GitHub - zoni/obsidian-export: Rust library and CLI to export an Obsidian vault to regular Markdown 提供了一个解决方式，遂决定切换到Hugo。
实施 支持相对路径 在Obsidian Vault中新建一个文件夹（这里记为Publish），在其中初始化Git仓库，存放供发布的文章。在Github上创建远端仓库并推送 用hugo new site命令创建站点文件夹（这里记为Site），同样初始化Git仓库。在Github上创建xxx.github.io名称的仓库并推送 与Hexo一样，Hugo同样支持主题，这里选用了PaperMod | Hugo Themes 在主题的layouts/_default/_markup/render-image.html中（若无该文件则新建），加入以下代码片段以支持相对路径引用图片： {{- $url := urls.Parse .Destination -}} {{- $scheme := $url.Scheme -}} &lt;a href=" {{- if eq $scheme "" -}} {{- if strings....</p></div><footer class=entry-footer><span title='2023-04-06 09:43:51 +0000 UTC'>2023-04-06</span>&nbsp;·&nbsp;Qiao</footer><a class=entry-link aria-label="post link to 从Hexo到Hugo" href=https://tanjoe.github.io/posts/%E4%BB%8Ehexo%E5%88%B0hugo/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://tanjoe.github.io/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://tanjoe.github.io/>Qiao</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>